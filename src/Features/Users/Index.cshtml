@using PhotoExhibiter.Features.Users
@model Index.Model

@inject UserManager<ApplicationUser> UserManager
@inject SignInManager<ApplicationUser> SignInManager

@if (Model.UserId == Model.PhotographerId)
{
  <h2 class="text-center voffset2">My Exhibits</h2>
}
else
{
  <h2 class="text-center voffset2">@Model.PhotographerName's Exhibits</h2>
  <p class = "text-center">
    @if (User.Identity.IsAuthenticated)
    {
      if (Model.IsFollowing)
      {
        <button class="btn btn-outline-info btn-sm js-toggle-follow"
            data-user-id="@Model.PhotographerId">Following</button>
      }
      else
      {
        <button class="btn btn-outline-secondary btn-sm js-toggle-follow"
            data-user-id="@Model.PhotographerId">Follow</button>
      }
    }
  </p>
}
<section class="container">
  <div class="row">

    <div class="col order-2">
<ul class="nav nav-pills mb-3" id="pills-tab" role="tablist">
  <li class="nav-item">
    <a class="nav-link active" id="pills-home-tab" data-toggle="pill" href="#pills-home" role="tab" aria-controls="pills-home" aria-selected="true">Home</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" id="pills-profile-tab" data-toggle="pill" href="#pills-profile" role="tab" aria-controls="pills-profile" aria-selected="false">Profile</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" id="pills-contact-tab" data-toggle="pill" href="#pills-contact" role="tab" aria-controls="pills-contact" aria-selected="false">Contact</a>
  </li>
</ul>
<div class="tab-content" id="pills-tabContent">
  <div class="tab-pane fade show active" id="pills-home" role="tabpanel" aria-labelledby="pills-home-tab">...</div>
  <div class="tab-pane fade" id="pills-profile" role="tabpanel" aria-labelledby="pills-profile-tab">...</div>
  <div class="tab-pane fade" id="pills-contact" role="tabpanel" aria-labelledby="pills-contact-tab">...</div>
</div>

      <ul id = "exhibits" class="exhibits voffset4">
        @foreach (var exhibit in Model.UpcomingExhibits)
        {
          <li>
            <div style="display:flex">

              <div class="date">
                <div class="month">
                  @exhibit.DateTime.ToString("MMM")
                </div>
                <div class="day">
                    @exhibit.DateTime.ToString("d ")
                </div>
              </div>

              <img class="img-thumbnail" style="height:100px;" src=@exhibit.ImageUrl>

              <div style="padding:10px">
                <div>
                  <b>@exhibit.Location</b>
                </div>
                <div>
                  @exhibit.Genre.Name
                </div>
                @if (Model.UserId == Model.PhotographerId)
                {
                  <div class="actions">
                    <a href="@Url.Action("Edit", "Exhibits", new { Id = exhibit.Id })">
                      Edit
                    </a>
                    <a href="#" class="js-cancel-exhibit"
                      data-exhibit-id="@exhibit.Id">
                      Cancel
                    </a>
                  </div>
                 }

                <div>
                  @if (Model.ShowActions && !exhibit.IsCanceled)
                  {
                    <button
                      data-exhibit-id="@exhibit.Id"
                      class="btn @(Model.Attendances.Any(a => a.ExhibitId == @exhibit.Id && a.AttendeeId == @Model.UserId) 
                      ? "btn-outline-info" 
                      : "btn-outline-secondary") btn-sm js-toggle-attendance">
                      @(Model.Attendances.Any(a => a.ExhibitId == @exhibit.Id && a.AttendeeId == @Model.UserId) 
                      ? "Attending"
                      : "Attend")
                    </button>
                  }
                </div>

              </div>

            </div>
          </li>
        }
      </ul>
    </div>

    <div class="col order-1">
      <gravatar image-size=402 default-image="Identicon" email-address="awesomeness@awesome.net"></gravatar>

    </div>

  </div>

</section>


@section search
{
  <form asp-controller="Exhibits" asp-action="Search">
    <div class="form-horizontal">
      <div id="searchexhibits" class="input-group">
        @Html.TextBoxFor(m => m.SearchTerm, new { @class = "form-control",
        placeholder = "Search by Photographer, Genre or Location..." })
        <button class="btn btn-outline-success" type="submit">Search</button>
      </div>
    </div>
  </form>
}

@section scripts
{
  <script type="text/javascript" src="~/exhibits.js"></script>
  <script type="text/javascript" src="~/exhibitCancel.js"></script>
  <script type="text/javascript" src="~/exhibitDetails.js"></script>
}
